
After rating==5 & 10-core + LOO:
Train size: 214579   Test size: 4814
Unique users in train: 4814, in test: 4814

Users shape: (6040, 5)
Movies shape: (3883, 3)
Loaded ML-1M data: train=214579, test=4814
Number of mapped users=4814, items=3223
Scenario A: 172904 rows (each cold user => 1 real)

--- Training Scenario A (cold=1 real) ...
Epoch 1/5

  1/169 [..............................] - ETA: 48s - loss: 0.0118 - regularization_loss: 0.0000e+00 - total_loss: 0.0118
 18/169 [==>...........................] - ETA: 0s - loss: 0.0119 - regularization_loss: 0.0000e+00 - total_loss: 0.0119 
 36/169 [=====>........................] - ETA: 0s - loss: 0.0119 - regularization_loss: 0.0000e+00 - total_loss: 0.0119
 54/169 [========>.....................] - ETA: 0s - loss: 0.0119 - regularization_loss: 0.0000e+00 - total_loss: 0.0119
 71/169 [===========>..................] - ETA: 0s - loss: 0.0119 - regularization_loss: 0.0000e+00 - total_loss: 0.0119
 88/169 [==============>...............] - ETA: 0s - loss: 0.0119 - regularization_loss: 0.0000e+00 - total_loss: 0.0119
105/169 [=================>............] - ETA: 0s - loss: 0.0119 - regularization_loss: 0.0000e+00 - total_loss: 0.0119
124/169 [=====================>........] - ETA: 0s - loss: 0.0119 - regularization_loss: 0.0000e+00 - total_loss: 0.0119
142/169 [========================>.....] - ETA: 0s - loss: 0.0119 - regularization_loss: 0.0000e+00 - total_loss: 0.0119
160/169 [===========================>..] - ETA: 0s - loss: 0.0119 - regularization_loss: 0.0000e+00 - total_loss: 0.0119
169/169 [==============================] - 1s 3ms/step - loss: 0.0119 - regularization_loss: 0.0000e+00 - total_loss: 0.0119
Epoch 2/5

  1/169 [..............................] - ETA: 0s - loss: 0.0112 - regularization_loss: 0.0000e+00 - total_loss: 0.0112
 18/169 [==>...........................] - ETA: 0s - loss: 0.0113 - regularization_loss: 0.0000e+00 - total_loss: 0.0113
 36/169 [=====>........................] - ETA: 0s - loss: 0.0114 - regularization_loss: 0.0000e+00 - total_loss: 0.0114
 53/169 [========>.....................] - ETA: 0s - loss: 0.0114 - regularization_loss: 0.0000e+00 - total_loss: 0.0114
 71/169 [===========>..................] - ETA: 0s - loss: 0.0114 - regularization_loss: 0.0000e+00 - total_loss: 0.0114
 88/169 [==============>...............] - ETA: 0s - loss: 0.0114 - regularization_loss: 0.0000e+00 - total_loss: 0.0114
105/169 [=================>............] - ETA: 0s - loss: 0.0114 - regularization_loss: 0.0000e+00 - total_loss: 0.0114
122/169 [====================>.........] - ETA: 0s - loss: 0.0114 - regularization_loss: 0.0000e+00 - total_loss: 0.0114
139/169 [=======================>......] - ETA: 0s - loss: 0.0114 - regularization_loss: 0.0000e+00 - total_loss: 0.0114
155/169 [==========================>...] - ETA: 0s - loss: 0.0114 - regularization_loss: 0.0000e+00 - total_loss: 0.0114
169/169 [==============================] - 1s 3ms/step - loss: 0.0114 - regularization_loss: 0.0000e+00 - total_loss: 0.0114
Epoch 3/5

  1/169 [..............................] - ETA: 0s - loss: 0.0110 - regularization_loss: 0.0000e+00 - total_loss: 0.0110
 18/169 [==>...........................] - ETA: 0s - loss: 0.0111 - regularization_loss: 0.0000e+00 - total_loss: 0.0111
 36/169 [=====>........................] - ETA: 0s - loss: 0.0111 - regularization_loss: 0.0000e+00 - total_loss: 0.0111
 54/169 [========>.....................] - ETA: 0s - loss: 0.0111 - regularization_loss: 0.0000e+00 - total_loss: 0.0111
 72/169 [===========>..................] - ETA: 0s - loss: 0.0112 - regularization_loss: 0.0000e+00 - total_loss: 0.0112
 90/169 [==============>...............] - ETA: 0s - loss: 0.0112 - regularization_loss: 0.0000e+00 - total_loss: 0.0112
108/169 [==================>...........] - ETA: 0s - loss: 0.0112 - regularization_loss: 0.0000e+00 - total_loss: 0.0112
127/169 [=====================>........] - ETA: 0s - loss: 0.0112 - regularization_loss: 0.0000e+00 - total_loss: 0.0112
145/169 [========================>.....] - ETA: 0s - loss: 0.0112 - regularization_loss: 0.0000e+00 - total_loss: 0.0112
163/169 [===========================>..] - ETA: 0s - loss: 0.0111 - regularization_loss: 0.0000e+00 - total_loss: 0.0111
169/169 [==============================] - 0s 3ms/step - loss: 0.0111 - regularization_loss: 0.0000e+00 - total_loss: 0.0111
Epoch 4/5

  1/169 [..............................] - ETA: 0s - loss: 0.0108 - regularization_loss: 0.0000e+00 - total_loss: 0.0108
 19/169 [==>...........................] - ETA: 0s - loss: 0.0109 - regularization_loss: 0.0000e+00 - total_loss: 0.0109
 37/169 [=====>........................] - ETA: 0s - loss: 0.0110 - regularization_loss: 0.0000e+00 - total_loss: 0.0110
 55/169 [========>.....................] - ETA: 0s - loss: 0.0110 - regularization_loss: 0.0000e+00 - total_loss: 0.0110
 74/169 [============>.................] - ETA: 0s - loss: 0.0110 - regularization_loss: 0.0000e+00 - total_loss: 0.0110
 92/169 [===============>..............] - ETA: 0s - loss: 0.0110 - regularization_loss: 0.0000e+00 - total_loss: 0.0110
109/169 [==================>...........] - ETA: 0s - loss: 0.0110 - regularization_loss: 0.0000e+00 - total_loss: 0.0110
127/169 [=====================>........] - ETA: 0s - loss: 0.0110 - regularization_loss: 0.0000e+00 - total_loss: 0.0110
145/169 [========================>.....] - ETA: 0s - loss: 0.0110 - regularization_loss: 0.0000e+00 - total_loss: 0.0110
163/169 [===========================>..] - ETA: 0s - loss: 0.0110 - regularization_loss: 0.0000e+00 - total_loss: 0.0110
169/169 [==============================] - 0s 3ms/step - loss: 0.0110 - regularization_loss: 0.0000e+00 - total_loss: 0.0110
Epoch 5/5

  1/169 [..............................] - ETA: 0s - loss: 0.0106 - regularization_loss: 0.0000e+00 - total_loss: 0.0106
 19/169 [==>...........................] - ETA: 0s - loss: 0.0107 - regularization_loss: 0.0000e+00 - total_loss: 0.0107
 37/169 [=====>........................] - ETA: 0s - loss: 0.0108 - regularization_loss: 0.0000e+00 - total_loss: 0.0108
 55/169 [========>.....................] - ETA: 0s - loss: 0.0108 - regularization_loss: 0.0000e+00 - total_loss: 0.0108
 73/169 [===========>..................] - ETA: 0s - loss: 0.0108 - regularization_loss: 0.0000e+00 - total_loss: 0.0108
 91/169 [===============>..............] - ETA: 0s - loss: 0.0108 - regularization_loss: 0.0000e+00 - total_loss: 0.0108
109/169 [==================>...........] - ETA: 0s - loss: 0.0108 - regularization_loss: 0.0000e+00 - total_loss: 0.0108
127/169 [=====================>........] - ETA: 0s - loss: 0.0108 - regularization_loss: 0.0000e+00 - total_loss: 0.0108
145/169 [========================>.....] - ETA: 0s - loss: 0.0108 - regularization_loss: 0.0000e+00 - total_loss: 0.0108
164/169 [============================>.] - ETA: 0s - loss: 0.0108 - regularization_loss: 0.0000e+00 - total_loss: 0.0108
169/169 [==============================] - 0s 3ms/step - loss: 0.0108 - regularization_loss: 0.0000e+00 - total_loss: 0.0108

Evaluating Scenario A (LOO+Negative Sampling)...
==== Scenario A Results ====
  HR@1=0.0104, NDCG@1=0.0104
  HR@3=0.0314, NDCG@3=0.0222
  HR@5=0.0511, NDCG@5=0.0303
  HR@10=0.1097, NDCG@10=0.0489
============================

Loaded augmented data with 6040 rows
Augmented rows for cold users: 953
Scenario B: 173857 total rows (1 real + augmented for cold)

--- Training Scenario B (cold=1 real + augmented) ...
Epoch 1/5

  1/170 [..............................] - ETA: 24s - loss: 0.0119 - regularization_loss: 0.0000e+00 - total_loss: 0.0119
 18/170 [==>...........................] - ETA: 0s - loss: 0.0119 - regularization_loss: 0.0000e+00 - total_loss: 0.0119 
 36/170 [=====>........................] - ETA: 0s - loss: 0.0119 - regularization_loss: 0.0000e+00 - total_loss: 0.0119
 54/170 [========>.....................] - ETA: 0s - loss: 0.0119 - regularization_loss: 0.0000e+00 - total_loss: 0.0119
 71/170 [===========>..................] - ETA: 0s - loss: 0.0119 - regularization_loss: 0.0000e+00 - total_loss: 0.0119
 89/170 [==============>...............] - ETA: 0s - loss: 0.0119 - regularization_loss: 0.0000e+00 - total_loss: 0.0119
106/170 [=================>............] - ETA: 0s - loss: 0.0119 - regularization_loss: 0.0000e+00 - total_loss: 0.0119
124/170 [====================>.........] - ETA: 0s - loss: 0.0119 - regularization_loss: 0.0000e+00 - total_loss: 0.0119
141/170 [=======================>......] - ETA: 0s - loss: 0.0119 - regularization_loss: 0.0000e+00 - total_loss: 0.0119
159/170 [===========================>..] - ETA: 0s - loss: 0.0119 - regularization_loss: 0.0000e+00 - total_loss: 0.0119
170/170 [==============================] - 1s 3ms/step - loss: 0.0119 - regularization_loss: 0.0000e+00 - total_loss: 0.0119
Epoch 2/5

  1/170 [..............................] - ETA: 0s - loss: 0.0111 - regularization_loss: 0.0000e+00 - total_loss: 0.0111
 18/170 [==>...........................] - ETA: 0s - loss: 0.0114 - regularization_loss: 0.0000e+00 - total_loss: 0.0114
 36/170 [=====>........................] - ETA: 0s - loss: 0.0114 - regularization_loss: 0.0000e+00 - total_loss: 0.0114
 54/170 [========>.....................] - ETA: 0s - loss: 0.0114 - regularization_loss: 0.0000e+00 - total_loss: 0.0114
 72/170 [===========>..................] - ETA: 0s - loss: 0.0114 - regularization_loss: 0.0000e+00 - total_loss: 0.0114
 90/170 [==============>...............] - ETA: 0s - loss: 0.0114 - regularization_loss: 0.0000e+00 - total_loss: 0.0114
107/170 [=================>............] - ETA: 0s - loss: 0.0114 - regularization_loss: 0.0000e+00 - total_loss: 0.0114
124/170 [====================>.........] - ETA: 0s - loss: 0.0114 - regularization_loss: 0.0000e+00 - total_loss: 0.0114
141/170 [=======================>......] - ETA: 0s - loss: 0.0114 - regularization_loss: 0.0000e+00 - total_loss: 0.0114
159/170 [===========================>..] - ETA: 0s - loss: 0.0114 - regularization_loss: 0.0000e+00 - total_loss: 0.0114
170/170 [==============================] - 1s 3ms/step - loss: 0.0114 - regularization_loss: 0.0000e+00 - total_loss: 0.0114
Epoch 3/5

  1/170 [..............................] - ETA: 0s - loss: 0.0109 - regularization_loss: 0.0000e+00 - total_loss: 0.0109
 18/170 [==>...........................] - ETA: 0s - loss: 0.0111 - regularization_loss: 0.0000e+00 - total_loss: 0.0111
 35/170 [=====>........................] - ETA: 0s - loss: 0.0111 - regularization_loss: 0.0000e+00 - total_loss: 0.0111
 53/170 [========>.....................] - ETA: 0s - loss: 0.0112 - regularization_loss: 0.0000e+00 - total_loss: 0.0112
 71/170 [===========>..................] - ETA: 0s - loss: 0.0112 - regularization_loss: 0.0000e+00 - total_loss: 0.0112
 89/170 [==============>...............] - ETA: 0s - loss: 0.0112 - regularization_loss: 0.0000e+00 - total_loss: 0.0112
106/170 [=================>............] - ETA: 0s - loss: 0.0112 - regularization_loss: 0.0000e+00 - total_loss: 0.0112
124/170 [====================>.........] - ETA: 0s - loss: 0.0112 - regularization_loss: 0.0000e+00 - total_loss: 0.0112
142/170 [========================>.....] - ETA: 0s - loss: 0.0112 - regularization_loss: 0.0000e+00 - total_loss: 0.0112
159/170 [===========================>..] - ETA: 0s - loss: 0.0112 - regularization_loss: 0.0000e+00 - total_loss: 0.0112
170/170 [==============================] - 0s 3ms/step - loss: 0.0112 - regularization_loss: 0.0000e+00 - total_loss: 0.0112
Epoch 4/5

  1/170 [..............................] - ETA: 0s - loss: 0.0106 - regularization_loss: 0.0000e+00 - total_loss: 0.0106
 17/170 [==>...........................] - ETA: 0s - loss: 0.0109 - regularization_loss: 0.0000e+00 - total_loss: 0.0109
 33/170 [====>.........................] - ETA: 0s - loss: 0.0109 - regularization_loss: 0.0000e+00 - total_loss: 0.0109
 50/170 [=======>......................] - ETA: 0s - loss: 0.0110 - regularization_loss: 0.0000e+00 - total_loss: 0.0110
 68/170 [===========>..................] - ETA: 0s - loss: 0.0110 - regularization_loss: 0.0000e+00 - total_loss: 0.0110
 85/170 [==============>...............] - ETA: 0s - loss: 0.0110 - regularization_loss: 0.0000e+00 - total_loss: 0.0110
103/170 [=================>............] - ETA: 0s - loss: 0.0110 - regularization_loss: 0.0000e+00 - total_loss: 0.0110
120/170 [====================>.........] - ETA: 0s - loss: 0.0110 - regularization_loss: 0.0000e+00 - total_loss: 0.0110
138/170 [=======================>......] - ETA: 0s - loss: 0.0110 - regularization_loss: 0.0000e+00 - total_loss: 0.0110
156/170 [==========================>...] - ETA: 0s - loss: 0.0110 - regularization_loss: 0.0000e+00 - total_loss: 0.0110
170/170 [==============================] - 1s 3ms/step - loss: 0.0110 - regularization_loss: 0.0000e+00 - total_loss: 0.0110
Epoch 5/5

  1/170 [..............................] - ETA: 0s - loss: 0.0107 - regularization_loss: 0.0000e+00 - total_loss: 0.0107
 18/170 [==>...........................] - ETA: 0s - loss: 0.0108 - regularization_loss: 0.0000e+00 - total_loss: 0.0108
 36/170 [=====>........................] - ETA: 0s - loss: 0.0108 - regularization_loss: 0.0000e+00 - total_loss: 0.0108
 54/170 [========>.....................] - ETA: 0s - loss: 0.0108 - regularization_loss: 0.0000e+00 - total_loss: 0.0108
 72/170 [===========>..................] - ETA: 0s - loss: 0.0108 - regularization_loss: 0.0000e+00 - total_loss: 0.0108
 89/170 [==============>...............] - ETA: 0s - loss: 0.0108 - regularization_loss: 0.0000e+00 - total_loss: 0.0108
106/170 [=================>............] - ETA: 0s - loss: 0.0108 - regularization_loss: 0.0000e+00 - total_loss: 0.0108
121/170 [====================>.........] - ETA: 0s - loss: 0.0108 - regularization_loss: 0.0000e+00 - total_loss: 0.0108
137/170 [=======================>......] - ETA: 0s - loss: 0.0108 - regularization_loss: 0.0000e+00 - total_loss: 0.0108
154/170 [==========================>...] - ETA: 0s - loss: 0.0108 - regularization_loss: 0.0000e+00 - total_loss: 0.0108
170/170 [==============================] - 1s 3ms/step - loss: 0.0108 - regularization_loss: 0.0000e+00 - total_loss: 0.0108

Evaluating Scenario B (LOO+Negative Sampling)...
==== Scenario B Results ====
  HR@1=0.0112, NDCG@1=0.0112
  HR@3=0.0337, NDCG@3=0.0240
  HR@5=0.0561, NDCG@5=0.0331
  HR@10=0.1086, NDCG@10=0.0498
============================

============ FINAL SUMMARY ============
Scenario A: each cold user => 1 real item
  HR@1=0.0104, NDCG@1=0.0104
  HR@3=0.0314, NDCG@3=0.0222
  HR@5=0.0511, NDCG@5=0.0303
  HR@10=0.1097, NDCG@10=0.0489

Scenario B: each cold user => 1 real + augmented data
  HR@1=0.0112, NDCG@1=0.0112
  HR@3=0.0337, NDCG@3=0.0240
  HR@5=0.0561, NDCG@5=0.0331
  HR@10=0.1086, NDCG@10=0.0498
========================================
