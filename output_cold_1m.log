
After rating==5 & 10-core + LOO:
Train size: 214579   Test size: 4814
Unique users in train: 4814, in test: 4814

Users shape: (6040, 5)
Movies shape: (3883, 3)
Original train size: 214579; test size: 4814
Reduced train size: 172904

Training the Two-Tower model on the reduced (cold-user) training set...
Epoch 1/5

  1/169 [..............................] - ETA: 52s - loss: 0.0119 - regularization_loss: 0.0000e+00 - total_loss: 0.0119
 17/169 [==>...........................] - ETA: 0s - loss: 0.0119 - regularization_loss: 0.0000e+00 - total_loss: 0.0119 
 33/169 [====>.........................] - ETA: 0s - loss: 0.0119 - regularization_loss: 0.0000e+00 - total_loss: 0.0119
 50/169 [=======>......................] - ETA: 0s - loss: 0.0119 - regularization_loss: 0.0000e+00 - total_loss: 0.0119
 66/169 [==========>...................] - ETA: 0s - loss: 0.0119 - regularization_loss: 0.0000e+00 - total_loss: 0.0119
 80/169 [=============>................] - ETA: 0s - loss: 0.0119 - regularization_loss: 0.0000e+00 - total_loss: 0.0119
 94/169 [===============>..............] - ETA: 0s - loss: 0.0119 - regularization_loss: 0.0000e+00 - total_loss: 0.0119
109/169 [==================>...........] - ETA: 0s - loss: 0.0119 - regularization_loss: 0.0000e+00 - total_loss: 0.0119
122/169 [====================>.........] - ETA: 0s - loss: 0.0119 - regularization_loss: 0.0000e+00 - total_loss: 0.0119
137/169 [=======================>......] - ETA: 0s - loss: 0.0119 - regularization_loss: 0.0000e+00 - total_loss: 0.0119
153/169 [==========================>...] - ETA: 0s - loss: 0.0119 - regularization_loss: 0.0000e+00 - total_loss: 0.0119
169/169 [==============================] - 1s 3ms/step - loss: 0.0119 - regularization_loss: 0.0000e+00 - total_loss: 0.0119
Epoch 2/5

  1/169 [..............................] - ETA: 0s - loss: 0.0111 - regularization_loss: 0.0000e+00 - total_loss: 0.0111
 15/169 [=>............................] - ETA: 0s - loss: 0.0113 - regularization_loss: 0.0000e+00 - total_loss: 0.0113
 30/169 [====>.........................] - ETA: 0s - loss: 0.0114 - regularization_loss: 0.0000e+00 - total_loss: 0.0114
 45/169 [======>.......................] - ETA: 0s - loss: 0.0114 - regularization_loss: 0.0000e+00 - total_loss: 0.0114
 60/169 [=========>....................] - ETA: 0s - loss: 0.0114 - regularization_loss: 0.0000e+00 - total_loss: 0.0114
 76/169 [============>.................] - ETA: 0s - loss: 0.0114 - regularization_loss: 0.0000e+00 - total_loss: 0.0114
 92/169 [===============>..............] - ETA: 0s - loss: 0.0114 - regularization_loss: 0.0000e+00 - total_loss: 0.0114
108/169 [==================>...........] - ETA: 0s - loss: 0.0114 - regularization_loss: 0.0000e+00 - total_loss: 0.0114
123/169 [====================>.........] - ETA: 0s - loss: 0.0114 - regularization_loss: 0.0000e+00 - total_loss: 0.0114
139/169 [=======================>......] - ETA: 0s - loss: 0.0114 - regularization_loss: 0.0000e+00 - total_loss: 0.0114
155/169 [==========================>...] - ETA: 0s - loss: 0.0114 - regularization_loss: 0.0000e+00 - total_loss: 0.0114
169/169 [==============================] - 1s 3ms/step - loss: 0.0114 - regularization_loss: 0.0000e+00 - total_loss: 0.0114
Epoch 3/5

  1/169 [..............................] - ETA: 0s - loss: 0.0110 - regularization_loss: 0.0000e+00 - total_loss: 0.0110
 16/169 [=>............................] - ETA: 0s - loss: 0.0111 - regularization_loss: 0.0000e+00 - total_loss: 0.0111
 32/169 [====>.........................] - ETA: 0s - loss: 0.0111 - regularization_loss: 0.0000e+00 - total_loss: 0.0111
 48/169 [=======>......................] - ETA: 0s - loss: 0.0111 - regularization_loss: 0.0000e+00 - total_loss: 0.0111
 65/169 [==========>...................] - ETA: 0s - loss: 0.0111 - regularization_loss: 0.0000e+00 - total_loss: 0.0111
 81/169 [=============>................] - ETA: 0s - loss: 0.0111 - regularization_loss: 0.0000e+00 - total_loss: 0.0111
 97/169 [================>.............] - ETA: 0s - loss: 0.0111 - regularization_loss: 0.0000e+00 - total_loss: 0.0111
113/169 [===================>..........] - ETA: 0s - loss: 0.0111 - regularization_loss: 0.0000e+00 - total_loss: 0.0111
129/169 [=====================>........] - ETA: 0s - loss: 0.0111 - regularization_loss: 0.0000e+00 - total_loss: 0.0111
145/169 [========================>.....] - ETA: 0s - loss: 0.0111 - regularization_loss: 0.0000e+00 - total_loss: 0.0111
161/169 [===========================>..] - ETA: 0s - loss: 0.0111 - regularization_loss: 0.0000e+00 - total_loss: 0.0111
169/169 [==============================] - 1s 3ms/step - loss: 0.0111 - regularization_loss: 0.0000e+00 - total_loss: 0.0111
Epoch 4/5

  1/169 [..............................] - ETA: 0s - loss: 0.0108 - regularization_loss: 0.0000e+00 - total_loss: 0.0108
 17/169 [==>...........................] - ETA: 0s - loss: 0.0109 - regularization_loss: 0.0000e+00 - total_loss: 0.0109
 33/169 [====>.........................] - ETA: 0s - loss: 0.0109 - regularization_loss: 0.0000e+00 - total_loss: 0.0109
 50/169 [=======>......................] - ETA: 0s - loss: 0.0109 - regularization_loss: 0.0000e+00 - total_loss: 0.0109
 67/169 [==========>...................] - ETA: 0s - loss: 0.0109 - regularization_loss: 0.0000e+00 - total_loss: 0.0109
 84/169 [=============>................] - ETA: 0s - loss: 0.0109 - regularization_loss: 0.0000e+00 - total_loss: 0.0109
101/169 [================>.............] - ETA: 0s - loss: 0.0109 - regularization_loss: 0.0000e+00 - total_loss: 0.0109
118/169 [===================>..........] - ETA: 0s - loss: 0.0109 - regularization_loss: 0.0000e+00 - total_loss: 0.0109
134/169 [======================>.......] - ETA: 0s - loss: 0.0109 - regularization_loss: 0.0000e+00 - total_loss: 0.0109
151/169 [=========================>....] - ETA: 0s - loss: 0.0109 - regularization_loss: 0.0000e+00 - total_loss: 0.0109
168/169 [============================>.] - ETA: 0s - loss: 0.0109 - regularization_loss: 0.0000e+00 - total_loss: 0.0109
169/169 [==============================] - 1s 3ms/step - loss: 0.0109 - regularization_loss: 0.0000e+00 - total_loss: 0.0109
Epoch 5/5

  1/169 [..............................] - ETA: 0s - loss: 0.0107 - regularization_loss: 0.0000e+00 - total_loss: 0.0107
 18/169 [==>...........................] - ETA: 0s - loss: 0.0107 - regularization_loss: 0.0000e+00 - total_loss: 0.0107
 34/169 [=====>........................] - ETA: 0s - loss: 0.0107 - regularization_loss: 0.0000e+00 - total_loss: 0.0107
 51/169 [========>.....................] - ETA: 0s - loss: 0.0108 - regularization_loss: 0.0000e+00 - total_loss: 0.0108
 66/169 [==========>...................] - ETA: 0s - loss: 0.0108 - regularization_loss: 0.0000e+00 - total_loss: 0.0108
 82/169 [=============>................] - ETA: 0s - loss: 0.0108 - regularization_loss: 0.0000e+00 - total_loss: 0.0108
 98/169 [================>.............] - ETA: 0s - loss: 0.0108 - regularization_loss: 0.0000e+00 - total_loss: 0.0108
115/169 [===================>..........] - ETA: 0s - loss: 0.0108 - regularization_loss: 0.0000e+00 - total_loss: 0.0108
132/169 [======================>.......] - ETA: 0s - loss: 0.0108 - regularization_loss: 0.0000e+00 - total_loss: 0.0108
148/169 [=========================>....] - ETA: 0s - loss: 0.0108 - regularization_loss: 0.0000e+00 - total_loss: 0.0108
165/169 [============================>.] - ETA: 0s - loss: 0.0107 - regularization_loss: 0.0000e+00 - total_loss: 0.0107
169/169 [==============================] - 1s 3ms/step - loss: 0.0107 - regularization_loss: 0.0000e+00 - total_loss: 0.0107

Evaluating the model (Leave-One-Out + Negative Sampling)...

Evaluation Results:
========================================
k         Hit Rate       NDCG           
----------------------------------------
1         0.0091     0.0091
3         0.0289     0.0203
5         0.0538     0.0305
10        0.1088     0.0481
========================================
