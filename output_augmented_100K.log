Ratings shape: (100000, 4)
Users shape: (943, 5)
Items shape: (1682, 24)
Train size: 80000 Test size: 20000
Number of cold users in test: 0
Number of warm users in test: 940
Loaded augmented data with 943 entries
Adding positive examples to augmented data...
Train size after filtering: 80000
Test size after filtering: 19969
Augmented size after filtering: 1043
Number of unique users: 943
Number of unique items: 1653
Training the model...
Epoch 1/10

[1m 1/79[0m [37m====================[0m [1m32s[0m 422ms/step - loss: 6.9312 - regularization_loss: 0.0000e+00 - total_loss: 6.9312
[1m19/79[0m [32m====[0m[37m================[0m [1m0s[0m 3ms/step - loss: 6.9315 - regularization_loss: 0.0000e+00 - total_loss: 6.9315   
[1m37/79[0m [32m=========[0m[37m===========[0m [1m0s[0m 3ms/step - loss: 6.9315 - regularization_loss: 0.0000e+00 - total_loss: 6.9315
[1m55/79[0m [32m=============[0m[37m=======[0m [1m0s[0m 3ms/step - loss: 6.9315 - regularization_loss: 0.0000e+00 - total_loss: 6.9315
[1m74/79[0m [32m==================[0m[37m==[0m [1m0s[0m 3ms/step - loss: 6.9316 - regularization_loss: 0.0000e+00 - total_loss: 6.9316
[1m79/79[0m [32m====================[0m[37m[0m [1m1s[0m 4ms/step - loss: 6.8796 - regularization_loss: 0.0000e+00 - total_loss: 6.8796 - val_loss: 6.2406 - val_regularization_loss: 0.0000e+00 - val_total_loss: 6.2406
Epoch 2/10

[1m 1/79[0m [37m====================[0m [1m0s[0m 11ms/step - loss: 6.9273 - regularization_loss: 0.0000e+00 - total_loss: 6.9273
[1m20/79[0m [32m=====[0m[37m===============[0m [1m0s[0m 3ms/step - loss: 6.9293 - regularization_loss: 0.0000e+00 - total_loss: 6.9293 
[1m38/79[0m [32m=========[0m[37m===========[0m [1m0s[0m 3ms/step - loss: 6.9294 - regularization_loss: 0.0000e+00 - total_loss: 6.9294
[1m57/79[0m [32m==============[0m[37m======[0m [1m0s[0m 3ms/step - loss: 6.9293 - regularization_loss: 0.0000e+00 - total_loss: 6.9293
[1m76/79[0m [32m===================[0m[37m=[0m [1m0s[0m 3ms/step - loss: 6.9290 - regularization_loss: 0.0000e+00 - total_loss: 6.9290
[1m79/79[0m [32m====================[0m[37m[0m [1m0s[0m 3ms/step - loss: 6.8768 - regularization_loss: 0.0000e+00 - total_loss: 6.8768 - val_loss: 6.2386 - val_regularization_loss: 0.0000e+00 - val_total_loss: 6.2386
Epoch 3/10

[1m 1/79[0m [37m====================[0m [1m0s[0m 10ms/step - loss: 6.9224 - regularization_loss: 0.0000e+00 - total_loss: 6.9224
[1m20/79[0m [32m=====[0m[37m===============[0m [1m0s[0m 3ms/step - loss: 6.9238 - regularization_loss: 0.0000e+00 - total_loss: 6.9238 
[1m38/79[0m [32m=========[0m[37m===========[0m [1m0s[0m 3ms/step - loss: 6.9227 - regularization_loss: 0.0000e+00 - total_loss: 6.9227
[1m57/79[0m [32m==============[0m[37m======[0m [1m0s[0m 3ms/step - loss: 6.9208 - regularization_loss: 0.0000e+00 - total_loss: 6.9208
[1m75/79[0m [32m==================[0m[37m==[0m [1m0s[0m 3ms/step - loss: 6.9184 - regularization_loss: 0.0000e+00 - total_loss: 6.9184
[1m79/79[0m [32m====================[0m[37m[0m [1m0s[0m 3ms/step - loss: 6.8653 - regularization_loss: 0.0000e+00 - total_loss: 6.8653 - val_loss: 6.2219 - val_regularization_loss: 0.0000e+00 - val_total_loss: 6.2219
Epoch 4/10

[1m 1/79[0m [37m====================[0m [1m0s[0m 10ms/step - loss: 6.8968 - regularization_loss: 0.0000e+00 - total_loss: 6.8968
[1m21/79[0m [32m=====[0m[37m===============[0m [1m0s[0m 3ms/step - loss: 6.8948 - regularization_loss: 0.0000e+00 - total_loss: 6.8948 
[1m41/79[0m [32m==========[0m[37m==========[0m [1m0s[0m 3ms/step - loss: 6.8876 - regularization_loss: 0.0000e+00 - total_loss: 6.8876
[1m60/79[0m [32m===============[0m[37m=====[0m [1m0s[0m 3ms/step - loss: 6.8795 - regularization_loss: 0.0000e+00 - total_loss: 6.8795
[1m78/79[0m [32m===================[0m[37m=[0m [1m0s[0m 3ms/step - loss: 6.8704 - regularization_loss: 0.0000e+00 - total_loss: 6.8704
[1m79/79[0m [32m====================[0m[37m[0m [1m0s[0m 3ms/step - loss: 6.8174 - regularization_loss: 0.0000e+00 - total_loss: 6.8174 - val_loss: 6.1654 - val_regularization_loss: 0.0000e+00 - val_total_loss: 6.1654
Epoch 5/10

[1m 1/79[0m [37m====================[0m [1m0s[0m 10ms/step - loss: 6.8150 - regularization_loss: 0.0000e+00 - total_loss: 6.8150
[1m20/79[0m [32m=====[0m[37m===============[0m [1m0s[0m 3ms/step - loss: 6.8122 - regularization_loss: 0.0000e+00 - total_loss: 6.8122 
[1m40/79[0m [32m==========[0m[37m==========[0m [1m0s[0m 3ms/step - loss: 6.8004 - regularization_loss: 0.0000e+00 - total_loss: 6.8004
[1m60/79[0m [32m===============[0m[37m=====[0m [1m0s[0m 3ms/step - loss: 6.7887 - regularization_loss: 0.0000e+00 - total_loss: 6.7887
[1m79/79[0m [32m====================[0m[37m[0m [1m0s[0m 3ms/step - loss: 6.7243 - regularization_loss: 0.0000e+00 - total_loss: 6.7243 - val_loss: 6.0936 - val_regularization_loss: 0.0000e+00 - val_total_loss: 6.0936
Epoch 6/10

[1m 1/79[0m [37m====================[0m [1m0s[0m 10ms/step - loss: 6.7094 - regularization_loss: 0.0000e+00 - total_loss: 6.7094
[1m21/79[0m [32m=====[0m[37m===============[0m [1m0s[0m 3ms/step - loss: 6.7132 - regularization_loss: 0.0000e+00 - total_loss: 6.7132 
[1m41/79[0m [32m==========[0m[37m==========[0m [1m0s[0m 3ms/step - loss: 6.7049 - regularization_loss: 0.0000e+00 - total_loss: 6.7049
[1m62/79[0m [32m===============[0m[37m=====[0m [1m0s[0m 3ms/step - loss: 6.6959 - regularization_loss: 0.0000e+00 - total_loss: 6.6959
[1m79/79[0m [32m====================[0m[37m[0m [1m0s[0m 3ms/step - loss: 6.6350 - regularization_loss: 0.0000e+00 - total_loss: 6.6350 - val_loss: 6.0394 - val_regularization_loss: 0.0000e+00 - val_total_loss: 6.0394
Epoch 7/10

[1m 1/79[0m [37m====================[0m [1m0s[0m 10ms/step - loss: 6.6289 - regularization_loss: 0.0000e+00 - total_loss: 6.6289
[1m20/79[0m [32m=====[0m[37m===============[0m [1m0s[0m 3ms/step - loss: 6.6391 - regularization_loss: 0.0000e+00 - total_loss: 6.6391 
[1m40/79[0m [32m==========[0m[37m==========[0m [1m0s[0m 3ms/step - loss: 6.6346 - regularization_loss: 0.0000e+00 - total_loss: 6.6346
[1m60/79[0m [32m===============[0m[37m=====[0m [1m0s[0m 3ms/step - loss: 6.6290 - regularization_loss: 0.0000e+00 - total_loss: 6.6290
[1m79/79[0m [32m====================[0m[37m[0m [1m0s[0m 3ms/step - loss: 6.5689 - regularization_loss: 0.0000e+00 - total_loss: 6.5689 - val_loss: 6.0016 - val_regularization_loss: 0.0000e+00 - val_total_loss: 6.0016
Epoch 8/10

[1m 1/79[0m [37m====================[0m [1m0s[0m 9ms/step - loss: 6.5721 - regularization_loss: 0.0000e+00 - total_loss: 6.5721
[1m21/79[0m [32m=====[0m[37m===============[0m [1m0s[0m 3ms/step - loss: 6.5842 - regularization_loss: 0.0000e+00 - total_loss: 6.5842
[1m40/79[0m [32m==========[0m[37m==========[0m [1m0s[0m 3ms/step - loss: 6.5825 - regularization_loss: 0.0000e+00 - total_loss: 6.5825
[1m60/79[0m [32m===============[0m[37m=====[0m [1m0s[0m 3ms/step - loss: 6.5786 - regularization_loss: 0.0000e+00 - total_loss: 6.5786
[1m79/79[0m [32m====================[0m[37m[0m [1m0s[0m 3ms/step - loss: 6.5192 - regularization_loss: 0.0000e+00 - total_loss: 6.5192 - val_loss: 5.9742 - val_regularization_loss: 0.0000e+00 - val_total_loss: 5.9742
Epoch 9/10

[1m 1/79[0m [37m====================[0m [1m0s[0m 9ms/step - loss: 6.5261 - regularization_loss: 0.0000e+00 - total_loss: 6.5261
[1m21/79[0m [32m=====[0m[37m===============[0m [1m0s[0m 3ms/step - loss: 6.5418 - regularization_loss: 0.0000e+00 - total_loss: 6.5418
[1m41/79[0m [32m==========[0m[37m==========[0m [1m0s[0m 3ms/step - loss: 6.5415 - regularization_loss: 0.0000e+00 - total_loss: 6.5415
[1m61/79[0m [32m===============[0m[37m=====[0m [1m0s[0m 3ms/step - loss: 6.5382 - regularization_loss: 0.0000e+00 - total_loss: 6.5382
[1m79/79[0m [32m====================[0m[37m[0m [1m0s[0m 3ms/step - loss: 6.4793 - regularization_loss: 0.0000e+00 - total_loss: 6.4793 - val_loss: 5.9535 - val_regularization_loss: 0.0000e+00 - val_total_loss: 5.9535
Epoch 10/10

[1m 1/79[0m [37m====================[0m [1m0s[0m 9ms/step - loss: 6.4893 - regularization_loss: 0.0000e+00 - total_loss: 6.4893
[1m20/79[0m [32m=====[0m[37m===============[0m [1m0s[0m 3ms/step - loss: 6.5068 - regularization_loss: 0.0000e+00 - total_loss: 6.5068
[1m39/79[0m [32m=========[0m[37m===========[0m [1m0s[0m 3ms/step - loss: 6.5070 - regularization_loss: 0.0000e+00 - total_loss: 6.5070
[1m57/79[0m [32m==============[0m[37m======[0m [1m0s[0m 3ms/step - loss: 6.5054 - regularization_loss: 0.0000e+00 - total_loss: 6.5054
[1m75/79[0m [32m==================[0m[37m==[0m [1m0s[0m 3ms/step - loss: 6.5031 - regularization_loss: 0.0000e+00 - total_loss: 6.5031
[1m79/79[0m [32m====================[0m[37m[0m [1m0s[0m 4ms/step - loss: 6.4460 - regularization_loss: 0.0000e+00 - total_loss: 6.4460 - val_loss: 5.9374 - val_regularization_loss: 0.0000e+00 - val_total_loss: 5.9374
Evaluating on original test data...

[1m 1/20[0m [32m=[0m[37m===================[0m [1m0s[0m 7ms/step - loss: 6.5971 - regularization_loss: 0.0000e+00 - total_loss: 6.5971
[1m20/20[0m [32m====================[0m[37m[0m [1m0s[0m 3ms/step - loss: 6.5311 - regularization_loss: 0.0000e+00 - total_loss: 6.5311

Original test evaluation loss: {'loss': <tf.Tensor: shape=(), dtype=float32, numpy=5.937411785125732>, 'regularization_loss': <tf.Tensor: shape=(), dtype=int32, numpy=0>, 'total_loss': <tf.Tensor: shape=(), dtype=float32, numpy=5.937411785125732>}

----- Original Test Data Metrics -----
Hit Rate (Top-1): 0.0026
NDCG (Top-1): 0.0026
Hit Rate (Top-3): 0.0078
NDCG (Top-3): 0.0055
Hit Rate (Top-5): 0.0129
NDCG (Top-5): 0.0076
Hit Rate (Top-10): 0.0270
NDCG (Top-10): 0.0121

Evaluating on augmented data...

[1m1/2[0m [32m==========[0m[37m==========[0m [1m0s[0m 11ms/step - loss: 7.2817 - regularization_loss: 0.0000e+00 - total_loss: 7.2817
[1m2/2[0m [32m====================[0m[37m[0m [1m0s[0m 4ms/step - loss: 4.1729 - regularization_loss: 0.0000e+00 - total_loss: 4.1729 

Augmented data evaluation loss: {'loss': <tf.Tensor: shape=(), dtype=float32, numpy=2.6184775829315186>, 'regularization_loss': <tf.Tensor: shape=(), dtype=int32, numpy=0>, 'total_loss': <tf.Tensor: shape=(), dtype=float32, numpy=2.6184775829315186>}

----- Augmented Data Metrics -----
Hit Rate (Top-1): 0.0010
NDCG (Top-1): 0.0010
Hit Rate (Top-3): 0.0038
NDCG (Top-3): 0.0024
Hit Rate (Top-5): 0.0077
NDCG (Top-5): 0.0040
Hit Rate (Top-10): 0.0173
NDCG (Top-10): 0.0071

Building recommendation index...
Item IDs tensor shape: (1653,)
All item embeddings shape: (1653, 32)
Successfully indexed embeddings!

Recommendations for original user 1
Top 10 recommended items: ['156', '184', '47', '169', '214', '42', '128', '160', '67', '163']

Recommendations for augmented user 1
Top 10 recommended items: ['156', '184', '47', '169', '214', '42', '128', '160', '67', '163']

ID Mapping Examples:
User: Original ID=1, Integer ID=1
User: Original ID=10, Integer ID=2
User: Original ID=100, Integer ID=3
User: Original ID=101, Integer ID=4
User: Original ID=102, Integer ID=5
Item: Original ID=1, Integer ID=1
Item: Original ID=10, Integer ID=2
Item: Original ID=100, Integer ID=3
Item: Original ID=1000, Integer ID=4
Item: Original ID=1001, Integer ID=5
