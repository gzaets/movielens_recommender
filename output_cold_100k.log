After leave-one-out split:
Train size: 99057 Test size: 943
Users shape: (943, 5)
Items shape: (1682, 24)
Original train size: 99057; test size: 943
Reduced train size: 81253

Training the Two-Tower model on the reduced (cold-user) training set...
Epoch 1/5

 1/80 [..............................] - ETA: 23s - loss: 0.0123 - regularization_loss: 0.0000e+00 - total_loss: 0.0123
17/80 [=====>........................] - ETA: 0s - loss: 0.0120 - regularization_loss: 0.0000e+00 - total_loss: 0.0120 
32/80 [===========>..................] - ETA: 0s - loss: 0.0119 - regularization_loss: 0.0000e+00 - total_loss: 0.0119
47/80 [================>.............] - ETA: 0s - loss: 0.0119 - regularization_loss: 0.0000e+00 - total_loss: 0.0119
63/80 [======================>.......] - ETA: 0s - loss: 0.0119 - regularization_loss: 0.0000e+00 - total_loss: 0.0119
80/80 [==============================] - ETA: 0s - loss: 0.0122 - regularization_loss: 0.0000e+00 - total_loss: 0.0122
80/80 [==============================] - 1s 3ms/step - loss: 0.0124 - regularization_loss: 0.0000e+00 - total_loss: 0.0124
Epoch 2/5

 1/80 [..............................] - ETA: 0s - loss: 0.0115 - regularization_loss: 0.0000e+00 - total_loss: 0.0115
17/80 [=====>........................] - ETA: 0s - loss: 0.0114 - regularization_loss: 0.0000e+00 - total_loss: 0.0114
33/80 [===========>..................] - ETA: 0s - loss: 0.0115 - regularization_loss: 0.0000e+00 - total_loss: 0.0115
49/80 [=================>............] - ETA: 0s - loss: 0.0115 - regularization_loss: 0.0000e+00 - total_loss: 0.0115
65/80 [=======================>......] - ETA: 0s - loss: 0.0115 - regularization_loss: 0.0000e+00 - total_loss: 0.0115
80/80 [==============================] - 0s 3ms/step - loss: 0.0119 - regularization_loss: 0.0000e+00 - total_loss: 0.0119
Epoch 3/5

 1/80 [..............................] - ETA: 0s - loss: 0.0113 - regularization_loss: 0.0000e+00 - total_loss: 0.0113
17/80 [=====>........................] - ETA: 0s - loss: 0.0112 - regularization_loss: 0.0000e+00 - total_loss: 0.0112
33/80 [===========>..................] - ETA: 0s - loss: 0.0113 - regularization_loss: 0.0000e+00 - total_loss: 0.0113
49/80 [=================>............] - ETA: 0s - loss: 0.0113 - regularization_loss: 0.0000e+00 - total_loss: 0.0113
65/80 [=======================>......] - ETA: 0s - loss: 0.0113 - regularization_loss: 0.0000e+00 - total_loss: 0.0113
80/80 [==============================] - 0s 3ms/step - loss: 0.0117 - regularization_loss: 0.0000e+00 - total_loss: 0.0117
Epoch 4/5

 1/80 [..............................] - ETA: 0s - loss: 0.0111 - regularization_loss: 0.0000e+00 - total_loss: 0.0111
18/80 [=====>........................] - ETA: 0s - loss: 0.0111 - regularization_loss: 0.0000e+00 - total_loss: 0.0111
34/80 [===========>..................] - ETA: 0s - loss: 0.0111 - regularization_loss: 0.0000e+00 - total_loss: 0.0111
50/80 [=================>............] - ETA: 0s - loss: 0.0112 - regularization_loss: 0.0000e+00 - total_loss: 0.0112
65/80 [=======================>......] - ETA: 0s - loss: 0.0111 - regularization_loss: 0.0000e+00 - total_loss: 0.0111
80/80 [==============================] - 0s 3ms/step - loss: 0.0115 - regularization_loss: 0.0000e+00 - total_loss: 0.0115
Epoch 5/5

 1/80 [..............................] - ETA: 0s - loss: 0.0110 - regularization_loss: 0.0000e+00 - total_loss: 0.0110
17/80 [=====>........................] - ETA: 0s - loss: 0.0110 - regularization_loss: 0.0000e+00 - total_loss: 0.0110
33/80 [===========>..................] - ETA: 0s - loss: 0.0110 - regularization_loss: 0.0000e+00 - total_loss: 0.0110
49/80 [=================>............] - ETA: 0s - loss: 0.0110 - regularization_loss: 0.0000e+00 - total_loss: 0.0110
65/80 [=======================>......] - ETA: 0s - loss: 0.0110 - regularization_loss: 0.0000e+00 - total_loss: 0.0110
80/80 [==============================] - 0s 3ms/step - loss: 0.0114 - regularization_loss: 0.0000e+00 - total_loss: 0.0114

Evaluating the model (Leave-One-Out + Negative Sampling)...

Evaluation Results:
========================================
k         Hit Rate       NDCG           
----------------------------------------
1         0.0085     0.0085
3         0.0233     0.0169
5         0.0392     0.0235
10        0.0933     0.0407
========================================
